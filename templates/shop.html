{% extends "base.html" %}

{% block content %}
<section class="container" style="margin-top: 100px;">
    <div class="section-title">
        <h2>متجر الملابس</h2>
    </div>

    <div style="margin-bottom: 30px; text-align: center;">
        <a href="{{ url_for('shop') }}" class="btn {% if not category %}active{% endif %}" style="margin: 5px;">الكل</a>
        <a href="{{ url_for('shop', category='رجالي') }}" class="btn {% if category == 'رجالي' %}active{% endif %}" style="margin: 5px;">رجالي</a>
        <a href="{{ url_for('shop', category='نسائي') }}" class="btn {% if category == 'نسائي' %}active{% endif %}" style="margin: 5px;">نسائي</a>
        <a href="{{ url_for('shop', category='اكسسوارات') }}" class="btn {% if category == 'اكسسوارات' %}active{% endif %}" style="margin: 5px;">اكسسوارات</a>
    </div>

    <div class="products-grid">
        {% for product in products.items %}
        <div class="product-card">
            <div class="product-image">
                <img src="{{ url_for('static', filename='uploads/' + product.image) }}" alt="{{ product.name }}">
            </div>
            <div class="product-info">
                <h3>{{ product.name }}</h3>
                <p style="color: #777; font-size: 14px; margin-bottom: 10px;">{{ product.category }}</p>
                <div class="product-price">
                    <span class="current-price">{{ product.price }} درهم</span>
                    {% if product.old_price %}
                    <span class="old-price">{{ product.old_price }} درهم</span>
                    {% endif %}
                </div>
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <a href="{{ url_for('product_detail', product_id=product.id) }}" class="btn btn-outline">عرض التفاصيل</a>
                    <a href="https://wa.me/212632256568?text={{ ('أهلاً، أريد طلب هذا المنتج: ' + product.name + ' - بسعر: ' + product.price|string + ' درهم') | urlencode }}" 
                       class="btn" 
                       style="background-color: #25D366; display: flex; align-items: center; justify-content: center; gap: 5px; padding: 8px;"
                       target="_blank">
                        <span style="font-size: 16px;">📱</span>
                        طلب سريع
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- التصفح بين الصفحات -->
    <div style="display: flex; justify-content: center; margin: 40px 0;">
        {% if products.has_prev %}
            <a href="{{ url_for('shop', page=products.prev_num, category=category) }}" class="btn" style="margin: 0 5px;">السابق</a>
        {% endif %}
        
        {% for page_num in products.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
            {% if page_num %}
                {% if products.page == page_num %}
                    <a href="{{ url_for('shop', page=page_num, category=category) }}" class="btn active" style="margin: 0 5px;">{{ page_num }}</a>
                {% else %}
                    <a href="{{ url_for('shop', page=page_num, category=category) }}" class="btn" style="margin: 0 5px;">{{ page_num }}</a>
                {% endif %}
            {% else %}
                <span class="btn" style="margin: 0 5px;">...</span>
            {% endif %}
        {% endfor %}
        
        {% if products.has_next %}
            <a href="{{ url_for('shop', page=products.next_num, category=category) }}" class="btn" style="margin: 0 5px;">التالي</a>
        {% endif %}
    </div>
</section>
{% endblock %}
